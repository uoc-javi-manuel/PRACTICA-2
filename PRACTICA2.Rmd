---
title: "PRÁCTICA 2 - TIPOLOGÍA Y CICLO DE VIDA DE LOS DATOS"
author: "Manuel Cubertorer Gumbau y Francisco Javier Corrales Estrella"
date: "11/12/2021"
output:
  pdf_document:
    toc: yes
  html_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Descripción del dataset. ¿Por qué es importante y qué pregunta/problema pretende responder?

Los conjuntos de datos corresponden a una serie de registros de tipos de vino, obtenidos a partir de:

https://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/

Se definen una serie atributos como la acidez o la graduación, y una variable target con la calidad del vino.
Extraeremos los dos dataset disponibles, uno para vinos blancos y otros para vinos tintos, y los fusionaremos en uno de solo creando una variable categórica para el tipo de vino, el resto de variables son numéricas.

Los campos de los que se compone el dataset son los siguientes:

- **fixed acidity**: most acids involved with wine or fixed or nonvolatile (do not evaporate readily)
- **volatile acidity**: the amount of acetic acid in wine, which at too high of levels can lead to an unpleasant, vinegar taste
- **citric acid**: found in small quantities, citric acid can add 'freshness' and flavor to wines
- **residual sugar**: the amount of sugar remaining after fermentation stops, it's rare to find wines with less than 1 gram/liter and wines with greater than 45 grams/liter are considered sweet
- **chlorides**: the amount of salt in the wine
- **free sulfur dioxide**: the free form of SO2 exists in equilibrium between molecular SO2 (as a dissolved gas) and bisulfite ion; it prevents microbial growth and the oxidation of wine
- **total sulfur dioxide**: amount of free and bound forms of S02; in low concentrations, SO2 is mostly undetectable in wine, but at free SO2 concentrations over 50 ppm, SO2 becomes evident in the nose and taste of wine
- **density**: the density of water is close to that of water depending on the percent alcohol and sugar content.
- **pH**: describes how acidic or basic a wine is on a scale from 0 (very acidic) to 14 (very basic); most wines are between 3-4 on the pH scale.
- **sulphates**: a wine additive which can contribute to sulfur dioxide gas (S02) levels, wich acts as an antimicrobial and antioxidant.
- **tipo_vino**: Variable categórica que distingue entre vinos blancos y vinos tintos.
- **quality**: Indica la calidad del vino en una escala del 1 al 10.


Nuestro análisis, tratará de determinar que variable/s son mas determinantes en la calidad del vino, y compararemos como influye en algunas de ellas el tipo de vino (blanco o tinto)


# 2. Integración y selección de los datos de interés a analizar

En primer lugar cargamos los datos desde el repositorio de datatsets UCI Machine Learning.

```{r message=FALSE, warning=FALSE}
red_wine_data <- read.csv("http://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/winequality-red.csv", header=T, sep=";")
white_wine_data <- read.csv("http://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/winequality-white.csv", header=T, sep=";")

colnames(red_wine_data) <- c("fixed_acidity","volatile_acidity", "citric_acid", "residual_sugar", "chlorides", "free_sulfur_dioxide","total_sulfur_dioxide","density","ph","sulphates","alcohol","quality")

colnames(white_wine_data) <- c("fixed_acidity","volatile_acidity", "citric_acid", "residual_sugar", "chlorides", "free_sulfur_dioxide","total_sulfur_dioxide","density","ph","sulphates","alcohol","quality")

red_wine_data$tipo <- 'tinto'
white_wine_data$tipo <- 'blanco'

wine_data = rbind(white_wine_data, red_wine_data)
```

Mostramos las primeras líneas del dataset para comprobar que se ha cargado correctamente.

Una **consideración importante**, es que no fusionaremos realmente los dos datasets hasta que hayamos completado las tareas de limpieza y preparación de datos pues no queremos que las distribuciones de los datos se mezclen, por ejemplo, los valores extremos los queremos tratar separados por cada tipo de vino.

```{r message= FALSE, warning=FALSE}
head(wine_data, -10)
```

A continuación mostraremos la estructura de los datos. Donde comprobamos que todas las variables son numéricas, excepto la variable categórica que hemos creado.

```{r message= FALSE, warning=FALSE}
str(wine_data)
```

Estadísticas principales de los datos:

```{r message= FALSE, warning=FALSE}
summary(wine_data)
```

# 3. Limpieza de los datos

## 3.1 ¿Los datos contienen ceros o elementos vacíos? ¿Cómo gestionarías cada uno de estos casos?

Mostramos las estadísticas de valores vacíos o nulos y vemos que en este caso no hay ninguno.

En caso de existir valores vacíos en algunos de los atributos, si fueran muy pocos, por simplicidad, se podrían eliminar estos datos sin que supusiera una importante pérdida de información en el resto de atributos. Pero en caso de ser algunos más, se podrían rellenar estos campos vacíos con la media de cada uno de los atributos. Otro método sería ver si los datos siguen una distribución lineal y tratar de predecir sus valores.

```{r message= FALSE, warning=FALSE}
# Estadísticas de valores vacíos
colSums(is.na(wine_data))
colSums(wine_data=="")
```

En nuestro caso no existen valores nulos, si los hubiese la alternativa mas sencilla es setear el valor de la media para todo el conjunto de datos. Esto lo podemos mejorar tomando alguna medida de tendencia central dependiendo de la distribución de los datos, esto se puede hacer para toda la muestra o en función de alguna variable categórica, en nuestro caso el tipo de vino.

Existen otros métodos, como  kNN que se basa en la similitud, basicamente se fija en que valores tiene esa variable en los "vecinos" mas cercanos, donde definimos cuantos vecinos queremos tomar.´



## 3.2 Identificación y tratamiento de valores extremos

Consideramos valores extremos como aquellos valores que son sospechosos por alejarse demasiado del resto de datos, esto en terminos numéricos quiere decir, que están demasiado alejados de la media teniendo en cuenta la desviación típica. Podemos hacer esta aproximación de una forma visual mediante un gráfico de caja o calculando los valores fuera del rango intercuartílico, podemos usar la función boxplots.stats() para esto

```{r message= FALSE, warning=FALSE}
myColors <- c(rgb(0.1,0.1,0.7,0.5) ,rgb(0.8,0.1,0.3,0.6))
              
fa_bp <- boxplot(wine_data$fixed_acidity ~ wine_data$tipo, main="Fixed Acidity", col =myColors )

```

```{r message= FALSE, warning=FALSE}
va_bp <- boxplot(wine_data$volatile_acidity ~ wine_data$tipo, main="Volatile Acidity", col =myColors )
```

```{r message= FALSE, warning=FALSE}
ca_bp <- boxplot(wine_data$citric_acid ~ wine_data$tipo, main="Citric Acid", col =myColors )
```
```{r message= FALSE, warning=FALSE}
rs_bp <- boxplot(wine_data$residual_sugar ~ wine_data$tipo, main="Residual Sugar", col =myColors )
```

```{r message= FALSE, warning=FALSE}
ch_bp <- boxplot(wine_data$chlorides ~ wine_data$tipo, main="Chlorides", col =myColors )
```

```{r message= FALSE, warning=FALSE}
fsd_bp <- boxplot(wine_data$free_sulfur_dioxide ~ wine_data$tipo, main="Free Sulfur Dioxide", col =myColors )
```

```{r message= FALSE, warning=FALSE}
tsd_bp <- boxplot(wine_data$total_sulfur_dioxide ~ wine_data$tipo, main="Total Sulfur Dioxide", col =myColors )
```

```{r message= FALSE, warning=FALSE}
de_bp <- boxplot(wine_data$density ~ wine_data$tipo, main="Density", col =myColors )
```

```{r message= FALSE, warning=FALSE}
ph_bp <- boxplot(wine_data$ph ~ wine_data$tipo, main="Ph", col =myColors )
```

```{r message= FALSE, warning=FALSE}
su_bp <- boxplot(wine_data$sulphates ~ wine_data$tipo, main="Sulphates", col =myColors )
```

```{r message= FALSE, warning=FALSE}
al_bp <- boxplot(wine_data$alcohol ~ wine_data$tipo, main="Alcohol", col =myColors )
```

# 4. Análisis de los datos

Nuestro análisis de datos está orientado a saber si hay diferencias en la calidad entre los vinos blancos y los vinos tintos, conocer que variables influyen mas en la calidad del vino y saber si podemos predecir y con que garantia que calidad tendrá un vino en función de sus atributos.


## 4.1 Selección de los grupos de datos que se quieren analizar/comparar (planificación de los análisis a aplicar).


## 4.2 Comprobación de la normalidad y homogenidad de la varianza


## 4.3 Aplicación de pruebas estadísticas para comparar los grupos de datos. En función de los datos y el objetivo del estudio, aplicar pruebas de contraste de hipótesis, correlaciones, regresiones, etc. Aplicar al menos tres métodos de análisis diferentes.
(COMPLETAR)
Vamos a aplicar las siguientes pruebas estadísticas. 

1. Comparación de dos grupos. Queremos hacer un contraste de hipótesis sobre si los vinos blancos tienen la misma caildad que los vinos tintos.

2. Comparación de mas de dos grupos  (ANOVA). Tomando la calidad del vino como una variable categórica, comprobaremos si algún valor como la acidez del vino son iguales o distitnos

3. Correlación,

4. Regresión lineal




# 5. Representación de los resultados a partir de tablas y gráficas


# 6. Resolución del problema. Apartir de los resultados obtenidos, ¿cuáles son las conclusiones? ¿Los resultados permiten responder al problema?


